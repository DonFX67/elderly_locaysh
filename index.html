<!DOCTYPE html>
<html>
<head>
  <title>Share My Location</title>
  <style>
    body { font-family: Arial; text-align: center; margin-top: 50px; }
    #mapLink { display: none; margin-top: 20px; font-size: 18px; color: blue; text-decoration: underline; }
    #status { font-size: 18px; margin-top: 20px; }
  </style>
</head>
<body>

<h1>Share Your Location</h1>
<p id="status">Waiting for your location...</p>
<a id="mapLink" target="_blank">View Your Location on Google Maps</a>

<script>
window.addEventListener('load', function() {
  const status = document.getElementById('status');
  const mapLink = document.getElementById('mapLink');

  if ("geolocation" in navigator) {
    navigator.geolocation.getCurrentPosition(
      function(position) {
        const lat = position.coords.latitude;
        const lon = position.coords.longitude;

        status.textContent = "Location shared successfully!";

        // Show Google Maps link
        mapLink.href = `https://www.google.com/maps?q=${lat},${lon}`;
        mapLink.style.display = 'block';

        // Send coordinates to Google Apps Script
        const scriptURL = 'https://script.google.com/macros/s/AKfycbwqcR5-IjU5y6pyn2D9wB235RdJ6-kojZj0q_Sd18mP8ifTxh76-i133wypG-gbfUHm/exec';
        fetch(`${scriptURL}?lat=${lat}&lon=${lon}`, { method: 'POST', mode: 'no-cors' });
      },
      function(error) {
        if(error.code === 1) {
          status.textContent = "Permission denied. Please allow location access.";
        } else {
          status.textContent = "Error retrieving location.";
        }
      }
    );
  } else {
    status.textContent = "Geolocation is not supported by your browser.";
  }
});
</script>

</body>
</html>
